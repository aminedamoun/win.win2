<!-- public/login.html (or login.html in your project) -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Login – Win Win</title>

  <style>
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#000;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      color:#fff;
    }
    .card{
      width:100%;
      max-width:420px;
      padding:40px;
      border-radius:16px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.15);
      backdrop-filter:blur(14px);
    }
    h1{text-align:center;margin-bottom:8px}
    h1 span{color:#e11d2e}
    p{text-align:center;color:#aaa;margin-bottom:30px}
    label{font-size:14px;color:#ccc}
    input{
      width:100%;
      margin:6px 0 18px;
      padding:12px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.2);
      background:rgba(255,255,255,.08);
      color:#fff;
      outline:none;
    }
    button{
      width:100%;
      padding:14px;
      border-radius:8px;
      border:none;
      background:#e11d2e;
      color:#fff;
      font-weight:600;
      cursor:pointer;
    }
    button:disabled{opacity:.7; cursor:not-allowed;}
    .error{
      display:none;
      margin-bottom:16px;
      padding:12px;
      border-radius:8px;
      background:rgba(220,38,38,.15);
      color:#ff6b6b;
      font-size:14px;
      line-height:1.35;
      word-break:break-word;
    }
    .hint{
      margin-top:14px;
      font-size:12px;
      color:#888;
      text-align:center;
    }
  </style>
</head>

<body>
  <div class="card">
    <h1>Win Win<span>.</span></h1>
    <p>Admin Login</p>

    <div id="error" class="error"></div>

    <form id="loginForm">
      <label>Email</label>
      <input id="email" type="email" autocomplete="email" required />

      <label>Password</label>
      <input id="password" type="password" autocomplete="current-password" required />

      <button type="submit">Sign In</button>
    </form>

    <div class="hint">If you’re already logged in, you’ll be redirected to Admin.</div>
  </div>

  <!-- Supabase JS library (v2) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    // ✅ PUT YOUR VALUES HERE (same ones you used in your React app)
    const SUPABASE_URL = "https://owvufovfnngqdhbscoci.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im93dnVmb3Zmbm5ncWRoYnNjb2NpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY0MTEwOTQsImV4cCI6MjA4MTk4NzA5NH0.sDDk9dKx_jHCEArBsyFzOrEMbSfHHnmZmcMD8znP2_I";

    // Create a CLIENT (this is what has .auth)
    window.supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
      auth: {
        storage: window.localStorage,
        autoRefreshToken: true,
        persistSession: true,
        detectSessionInUrl: false
      }
    });
  </script>

  <script>
    const errorBox = document.getElementById("error");
    const loginForm = document.getElementById("loginForm");
    const submitButton = loginForm.querySelector("button");

    function showError(message) {
      errorBox.textContent = message || "Login failed. Please try again.";
      errorBox.style.display = "block";
    }

    function clearError() {
      errorBox.textContent = "";
      errorBox.style.display = "none";
    }

    async function checkSession() {
      try {
        const { data, error } = await window.supabaseClient.auth.getSession();
        if (error) throw error;
        if (data?.session) {
          location.href = "/admin.html";
        }
      } catch (err) {
        console.error("Session check error:", err);
      }
    }

    checkSession();

    loginForm.onsubmit = async (e) => {
      e.preventDefault();
      clearError();

      submitButton.disabled = true;
      submitButton.textContent = "Signing in...";

      try {
        const emailValue = document.getElementById("email").value.trim();
        const passwordValue = document.getElementById("password").value;

        const { data, error } = await window.supabaseClient.auth.signInWithPassword({
          email: emailValue,
          password: passwordValue,
        });

        if (error) throw error;

        if (data?.session) {
          location.href = "/admin.html";
          return;
        }

        showError("No session returned. Please try again.");
      } catch (err) {
        console.error("Login error:", err);
        showError(err?.message);
      } finally {
        submitButton.disabled = false;
        submitButton.textContent = "Sign In";
      }
    };
  </script>
</body>
</html>
